# Домашнее задание к занятию 3 «Резервное копирование»

### Цель задания
В результате выполнения этого задания вы научитесь:
1. Настраивать регулярные задачи на резервное копирование (полная зеркальная копия)
2. Настраивать инкрементное резервное копирование с помощью rsync

---

### Задание 1
- Составьте команду rsync, которая позволяет создавать зеркальную копию домашней директории пользователя в директорию `/tmp/backup`
- Необходимо исключить из синхронизации все директории, начинающиеся с точки (скрытые)
- Необходимо сделать так, чтобы rsync подсчитывал хэш-суммы для всех файлов, даже если их время модификации и размер идентичны в источнике и приемнике.
- На проверку направить скриншот с командой и результатом ее выполнения
---
### ОТВЕТ НА ЗАДАНИЕ 1.

### 1.1 Команда для создания зеркальной копии домашней директории пользователя в директорию `/tmp/backup`.
```
 rsync -a --delete --exclude=".*" --checksum --progress /home/kupriyanov/ /tmp/backup/
```

#### 

`-a (archive)` — включает рекурсивное копирование, сохранение прав, времени модификации, символических ссылок и др.;

`--delete` — удаляет в приёмнике файлы, отсутствующие в источнике (обеспечивает «зеркальность»);

`--exclude=".*"` — исключает все элементы, чьи имена начинаются с точки (скрытые файлы и директории);

`--progress` — для каждого копируемого файла выводится информация, обновляемая во время передачи: размер файла, текущий процент прогресса, скорость передачи и оставшееся время

`--checksum` — сравнивает файлы по хэш‑суммам, а не по времени модификации и размеру.

### 1.2 Скриншоты работы команды.

![Скриншот-1](https://github.com/Yuriykup/Netology_9-03-hw-Public/blob/main/img/img1.png)
![Скриншот-2](https://github.com/Yuriykup/Netology_9-03-hw-Public/blob/main/img/img2.png)



### 1.3 Скриншот созданой папки с бэкапом.
![Скриншот-2](https://github.com/Yuriykup/Netology_9-03-hw-Public/blob/main/img/img3.png)
---

### Задание 2
- Написать скрипт и настроить задачу на регулярное резервное копирование домашней директории пользователя с помощью rsync и cron.
- Резервная копия должна быть полностью зеркальной
- Резервная копия должна создаваться раз в день, в системном логе должна появляться запись об успешном или неуспешном выполнении операции
- Резервная копия размещается локально, в директории `/tmp/backup`
- На проверку направить файл crontab и скриншот с результатом работы утилиты.

---
### ОТВЕТ НА ЗАДАНИЕ 2.

### 2.1 Создаю сринт на bash с названием `backup_home.sh` в папке /usr/local/bin/.

```
#!/bin/bash

# Параметры
SOURCE_DIR="$HOME/"               # Источник- домашняя папка
BACKUP_DIR="/tmp/backup/"         # Приёмник- место для бэкапа
LOG_FILE="/var/log/backup_home.log"  # Лог фйл

# Дата в логе
TIMESTAMP=$(date +"%Y-%m-%d %H:%M:%S")

# Команда rsync
rsync -a --delete --checksum --exclude=".*" "$SOURCE_DIR" "$BACKUP_DIR" >> "$LOG_FILE" 2>&1

if [ $? -eq 0 ]; then
    echo "[$TIMESTAMP] SUCCESS: БЕКАП ВЫПОЛНЕН УДАЧНО!" >> "$LOG_FILE"
else
    echo "[$TIMESTAMP] ERROR: БЕКАП ВЫПОЛНЕН НЕ УДАЧНО!!!" >> "$LOG_FILE"
fi
```
#### Пояснения к скрипту для rsync:

`>> "$LOG_FILE" 2>&1` — перенаправляет и вывод, и ошибки в лог‑файл;

`Проверка $?` — анализирует код возврата rsync (0 = успех, иначе — ошибка).

### 2.2. Устанавливаем разрешение на исполнение файла `backup_home.sh`.

`sudo chmod +x /usr/local/bin/backup_home.sh` 

### 2.3. Устанавливаем ежедневный запуск скрипта в 02:00.

`0 2 * * * /usr/local/bin/backup_home.sh`

#### Пояснение по расписанию:

`0` — минута (0);

`2` — час (2:00);

`*` — каждый день месяца;

`*` — каждый месяц;

`*` — каждый день недели.

### 2.4 Запуск скрипта и проверка выполнения.

### Скриншот выполнения и проверки скрипта.
![Скриншот-4](https://github.com/Yuriykup/Netology_9-03-hw-Public/blob/main/img/img4.png)

---
